"use strict";angular.module("dashboardApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/overview",{templateUrl:"views/main.html",controller:"OverViewCtrl"}).when("/billing",{templateUrl:"views/main.html",controller:"BillingCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("dashboardApp").controller("MainCtrl",["$scope","$location","user","Site",function(a,b,c,d){a.user=c,a.site=d,c.logIn("magdiel.david@gmail.com","default").then(function(){a.user.isLogin=!0,b.path("/"),a.$apply()},function(b){a.user.isLogin=!1,alert("Error",b.message)}),d.getAll(),a.addNewSite=function(){d.addNewSite(a.newSite.title)},function(){c.current()&&(a.user.isLogin=!1,b.path("/"))}()}]).controller("BillingCtrl",["$scope","$location","user",function(a,b,c){a.user=c,function(){c.current()&&(a.user.isLogin=!1,b.path("/"))}()}]),angular.module("dashboardApp").factory("user",["$location","$rootScope",function(a,b){return{logIn:function(a,c){return b.$broadcast("event:sessionUpdated"),Parse.User.logIn(a,c)},logOut:function(){Parse.User.logOut(),b.$broadcast("event:sessionUpdated"),this.isLogin=!1},current:function(){return Parse.User.current()},isAuthenticated:function(){return Parse.User.current()?(this.isLogin=!0,!0):(this.isLogin=!1,!1)},getName:function(){},isLogin:!1,name:""}}]).factory("Site",["$rootScope",function(a){var b={addNewSite:function(a){var b=Parse.Object.extend("Site"),c=new b,d=Parse.User.current().id;c.set("title",a),c.set("userId",d),c.save(null,{success:function(){},error:function(a,b){alert("Failed to create new object, with error code: "+b.message)}})},sites:[],getAll:function(){if(!Parse.User.current())return!1;var b=Parse.User.current().id,c=new Parse.Query("Site"),d=this;c.equalTo("userId",b),c.find().then(function(b){b=JSON.parse(JSON.stringify(b)),d.sites=b,a.$apply(),console.log("parentObjt: "+d.sites)},function(a){alert(a.message)})}};return b}]);